# Sphera_Project

## Descripption
Описание соревнования
Во множестве прикладных задач возникает необходимость разбить веб-страницы на какие-то определенные группы, где в каждой группе страницы будут очень похожи по смыслу. Например, представим, что Вы владелец сервиса интернет рекламы. Вашим клиентам хочется, чтобы их услуги рекламировались не на каком-то определенном сайте, а на всех сайтах их тематики. То есть Вам нужна какая-то тематическая разметка сайтов в интернете по множеству тематик, и клиент сможет выбрать любую, какая ему больше нравится. Как же такую разметку сделать?

Самый простой способ - разметить людьми множество сайтов в интернете на множество тем, настроить на этой выборке многоклассовый классификатор и сделать предсказанием на всем оставшемся "интернете". Однако, в таком подходе возникает несколько проблем. Во-первых, непонятно откуда брать само множество тем, на которое размечать. Во-вторых, даже если множество тем зафиксировано, не очень понятно, откуда для каждой темы брать примеры, чтобы добавить их в обучающее множество.

В данном задании мы предлагаем Вам попробовать другое решение. Пусть тематику задают сами данные! Разделим наши веб-страницы на множество групп, например, просто по словам в веб-страницах. В такой группе буду как документы об одном и том же, так и "аномалии", которые имеют схожие слова, но не соответствуют документам основной тематики. Например, в такой группе может содержаться подмножество веб-страниц про "ремонт пластиковых окон" и аномалии вроде "пластиковые игрушки", "ремонт квартир" и так далее. Нам останется только выделить подмножество документов одной темы, то есть все документы, которые про "ремонт пластовых окон" и убрать все аномалии. Затем подмножество как-то проименуем, чтобы показать клиенту, но этим Вы уже займетесь, когда будете продавать Вашу систему :)

В задании Вам предлагается работать с 28026 веб-страницами, которые уже скачаны и лежат в архиве content.tar.gz. Эти страницы разбиты по группам, каждая группа около 100 страниц. Каждая группа соответствует какой-то определенной теме, которая Вам неизвестна. Обучающее множество состоит из 129 групп. В обучающих группах ручной разметкой было проставлено, соответствует ли данный документ теме группы (target = 1) или это аномалия (target = 0). Тестовое множество состоит из 180 групп. Вам необходимо проставить для них target. Важно отметить, что обучающие и тестовые группы не пересекаются. Гарантируется, что в каждой группе есть подмножество документов из ее темы.


## Evaluation
Метрикой соревнования является классическая метрика двухклассовой классификации - F1 score. Подробно про нее можно прочитать, например, здесь https://en.wikipedia.org/wiki/F1_score

Формат предсказания
Файл с предсказаниями должен содержать два поля: pair_id и target (описание полей может посмотреть в "Data"), разделенных запятой. Идентификатор pair_id содержится в файлах test_groups.csv или sample_submission.csv.

Пример формата:

pair_id,target
11691,0


## Rules

Чего делать нельзя: 1) Нельзя обмениваться кодом между командами вне общего слака. 2) Нельзя использовать ручную разметку.

Все остальное можете использовать, то есть любые алгоритмы и любые дополнительные данные, которые находятся в свободном доступе.


## Описание файлов

### train_groups.csv:
Показывает из каких документов состоят группы для обучения. Содержит поле target, которое нужно предсказать для документов из тестовых групп
### test_groups.csv: 
Показывает из каких документов состоят группы для предсказания
### sample_submission.csv:
Пример предсказания на тестовом множестве для отправки на проверку
### content.tar.gz:
Архив с контентом веб-страниц
### docs_titles.tsv:
Заголовки для всех документов, взяты из content.tar.gz. Даны для упрощения домашних работ. Рекомендуется использовать ТОЛЬКО для домашних работ

## Описание полей

doc_id Уникальный идентификатор веб-страницы 

group_id - Уникальный идентификатор группы веб-страниц, среди которых нужно найти подмножество одной тематики 

pair_id - Уникальный идентификатор пары (group_id, doc_id) 

target - Значение, которое нужно предсказать. 1 - страница находится в подмножестве одной тематики, 0 - не находится 

title - Заголовок веб-страницы
